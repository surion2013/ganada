<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>검색 결과 - GaNaDa</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?display=swap&family=Noto+Sans:wght@400;500;700;900&family=Plus+Jakarta+Sans:wght@400;500;700;800">
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script src="navigation.js"></script>
</head>
<body>
    <div class="relative flex size-full min-h-screen flex-col bg-white group/design-root overflow-x-hidden" style="font-family: 'Plus Jakarta Sans', 'Noto Sans', sans-serif;">
        <div class="layout-container flex h-full grow flex-col min-h-screen">
            <div id="navigation-container"></div>

            <!-- Main Content -->
            <div class="px-4 md:px-40 flex flex-1 justify-center py-5">
                <div class="layout-content-container flex flex-col max-w-[960px] flex-1">
                    <!-- Search Bar -->
                    <div class="px-4 py-3">
                        <label class="flex flex-col min-w-40 h-12 w-full">
                            <div class="flex w-full flex-1 items-stretch rounded-xl h-full">
                                <div class="text-[#637488] flex border-none bg-[#f0f2f4] items-center justify-center pl-4 rounded-l-xl border-r-0">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                                        <path d="M229.66,218.34l-50.07-50.06a88.11,88.11,0,1,0-11.31,11.31l50.06,50.07a8,8,0,0,0,11.32-11.32ZM40,112a72,72,0,1,1,72,72A72.08,72.08,0,0,1,40,112Z"></path>
                                    </svg>
                                </div>
                                <input id="main-search" class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-xl text-[#111418] focus:outline-0 focus:ring-0 border-none bg-[#f0f2f4] focus:border-none h-full placeholder:text-[#637488] px-4 rounded-r-none border-r-0 pr-2 rounded-l-none border-l-0 pl-2 text-base font-normal leading-normal" value="" placeholder="작품, 계정, 태그 검색">
                                <div class="flex items-center justify-center rounded-r-xl border-l-0 border-none bg-[#f0f2f4] pr-2 pr-4">
                                    <button id="clear-search" class="flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-full bg-transparent text-[#111418] gap-2 text-base font-bold leading-normal tracking-[0.015em] h-auto min-w-0 px-0">
                                        <div class="text-[#637488]">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                                                <path d="M165.66,101.66,139.31,128l26.35,26.34a8,8,0,0,1-11.32,11.32L128,139.31l-26.34,26.35a8,8,0,0,1-11.32-11.32L116.69,128,90.34,101.66a8,8,0,0,1,11.32-11.32L128,116.69l26.34-26.35a8,8,0,0,1,11.32,11.32ZM232,128A104,104,0,1,1,128,24,104.11,104.11,0,0,1,232,128Zm-16,0a88,88,0,1,0-88,88A88.1,88.1,0,0,0,216,128Z"></path>
                                            </svg>
                                        </div>
                                    </button>
                                </div>
                            </div>
                        </label>
                    </div>

                    <!-- Tab Navigation -->
                    <div class="pb-3">
                        <div class="flex border-b border-[#dce0e5] px-4 gap-8">
                            <button class="search-tab flex flex-col items-center justify-center border-b-[3px] border-b-[#111418] text-[#111418] pb-[13px] pt-4" data-tab="top">
                                <p class="text-[#111418] text-sm font-bold leading-normal tracking-[0.015em]">인기</p>
                            </button>
                            <button class="search-tab flex flex-col items-center justify-center border-b-[3px] border-b-transparent text-[#637488] pb-[13px] pt-4" data-tab="accounts">
                                <p class="text-[#637488] text-sm font-bold leading-normal tracking-[0.015em]">계정</p>
                            </button>
                            <button class="search-tab flex flex-col items-center justify-center border-b-[3px] border-b-transparent text-[#637488] pb-[13px] pt-4" data-tab="tags">
                                <p class="text-[#637488] text-sm font-bold leading-normal tracking-[0.015em]">태그</p>
                            </button>
                        </div>
                    </div>

                    <!-- Search Results Grid -->
                    <div id="search-results" class="grid grid-cols-[repeat(auto-fit,minmax(180px,1fr))] md:grid-cols-[repeat(auto-fit,minmax(158px,1fr))] gap-4 md:gap-3 p-4">
                        <!-- Results will be populated here -->
                    </div>

                    <!-- No Results Message -->
                    <div id="no-results" class="hidden flex flex-col items-center justify-center py-20">
                        <div class="text-[#637488] mb-4">
                            <svg xmlns="http://www.w3.org/2000/svg" width="64px" height="64px" fill="currentColor" viewBox="0 0 256 256">
                                <path d="M229.66,218.34l-50.07-50.06a88.11,88.11,0,1,0-11.31,11.31l50.06,50.07a8,8,0,0,0,11.32-11.32ZM40,112a72,72,0,1,1,72,72A72.08,72.08,0,0,1,40,112Z"></path>
                            </svg>
                        </div>
                        <p class="text-[#637488] text-xl md:text-lg font-medium mb-2">검색 결과가 없습니다</p>
                        <p class="text-[#637488] text-base md:text-sm">다른 키워드로 검색해보세요</p>
                    </div>

                    <!-- Loading -->
                    <div id="loading" class="hidden flex items-center justify-center py-20">
                        <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-[#111418]"></div>
                    </div>
                </div>
            </div>
        </div>
        <div id="footer-container"></div>
    </div>

    <script>
        // Search data will be loaded from Supabase
        let searchData = {
            top: [],
            accounts: [],
            tags: []
        };

        let currentTab = 'top';

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            loadSearchResults();
            setupEventListeners();
        });

        function setupEventListeners() {
            // Tab switching
            document.querySelectorAll('.search-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabName = this.dataset.tab;
                    switchTab(tabName);
                });
            });

            // Clear search
            document.getElementById('clear-search').addEventListener('click', function() {
                document.getElementById('main-search').value = '';
            });

            // Search input
            document.getElementById('main-search').addEventListener('input', function() {
                const query = this.value;
                performSearch(query);
            });

            // Enter key search
            document.getElementById('main-search').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    performSearch(this.value);
                }
            });
        }

        function switchTab(tabName) {
            currentTab = tabName;
            
            // Update tab UI
            document.querySelectorAll('.search-tab').forEach(tab => {
                const isActive = tab.dataset.tab === tabName;
                tab.classList.toggle('border-b-[#111418]', isActive);
                tab.classList.toggle('border-b-transparent', !isActive);
                tab.classList.toggle('text-[#111418]', isActive);
                tab.classList.toggle('text-[#637488]', !isActive);
                
                const p = tab.querySelector('p');
                p.classList.toggle('text-[#111418]', isActive);
                p.classList.toggle('text-[#637488]', !isActive);
            });

            loadSearchResults();
        }

        function loadSearchResults() {
            const resultsContainer = document.getElementById('search-results');
            const noResults = document.getElementById('no-results');
            const loading = document.getElementById('loading');

            // Show loading
            loading.classList.remove('hidden');
            resultsContainer.innerHTML = '';
            noResults.classList.add('hidden');

            setTimeout(() => {
                loading.classList.add('hidden');
                
                const data = searchData[currentTab] || [];
                
                if (data.length === 0) {
                    noResults.classList.remove('hidden');
                    return;
                }

                resultsContainer.innerHTML = data.map(item => {
                    switch (item.type) {
                        case 'artwork':
                            return `
                                <div class="flex flex-col gap-3 cursor-pointer hover:opacity-80 transition-opacity" onclick="viewArtwork(${item.id})">
                                    <div class="w-full bg-center bg-no-repeat aspect-square bg-cover" style="background-image: url('${item.image}')"></div>
                                </div>
                            `;
                        case 'account':
                            return `
                                <div class="flex flex-col items-center p-4 bg-[#f8f9fa] rounded-xl hover:bg-[#f0f2f4] transition-colors cursor-pointer" onclick="viewProfile('${item.username}')">
                                    <div class="w-16 h-16 bg-center bg-no-repeat bg-cover rounded-full mb-3" style="background-image: url('${item.avatar}')"></div>
                                    <p class="text-sm font-bold text-[#111418] mb-1">${item.name}</p>
                                    <p class="text-xs text-[#637488] mb-2">@${item.username}</p>
                                    <p class="text-xs text-[#637488]">팔로워 ${item.followers}</p>
                                </div>
                            `;
                        case 'tag':
                            return `
                                <div class="flex flex-col cursor-pointer hover:opacity-80 transition-opacity" onclick="searchTag('${item.name}')">
                                    <div class="w-full bg-center bg-no-repeat aspect-square bg-cover mb-3" style="background-image: url('${item.preview}')"></div>
                                    <p class="text-sm font-bold text-[#111418] mb-1">${item.name}</p>
                                    <p class="text-xs text-[#637488]">${item.count}개 게시물</p>
                                </div>
                            `;
                        default:
                            return '';
                    }
                }).join('');
            }, 500);
        }

        function performSearch(query) {
            if (!query.trim()) {
                loadSearchResults();
                return;
            }

            // Simulate search
            const loading = document.getElementById('loading');
            const resultsContainer = document.getElementById('search-results');
            const noResults = document.getElementById('no-results');

            loading.classList.remove('hidden');
            resultsContainer.innerHTML = '';
            noResults.classList.add('hidden');

            setTimeout(() => {
                loading.classList.add('hidden');
                
                // TODO: Implement real search functionality with Supabase
                // For now, show empty results
                noResults.classList.remove('hidden');
            }, 800);
        }

        function viewArtwork(id) {
            window.location.href = `artwork.html?id=${id}`;
        }

        function viewProfile(username) {
            window.location.href = `profile.html?user=${username}`;
        }

        function searchTag(tag) {
            document.getElementById('main-search').value = tag;
            switchTab('top');
        }

        // Initialize navigation
        initNavigation('search');
    </script>
</body>
</html> 